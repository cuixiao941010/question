<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
	<title>invest</title>
<link rel="stylesheet" type="text/css" href="css/style.css">
<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="./layui/css/layui.css" />
<script type="text/javascript" src="js/jquery.cookie.js"></script>
<script src="./layui/layui.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<!-- header start -->
<div class="headerpage"></div>
<!-- end  -->
<input id="type" hidden>
<div class="invest_con_wper">
	  <div class="invest_con px1000">
	  	     <div class="product_choose">
				 <table id="tabledemo" lay-filter="test"></table>
				 <script type="text/html" id="barDemo">
					 <a class="layui-btn" lay-event="detail" style="line-height:28px;">查看</a>
					 <a class="layui-btn" lay-event="handle" style="line-height:28px;">办理</a>
				 </script>
	  	     </div>

	  </div>
</div>
<!-- footer start -->
<div class="footerpage"></div>
</body>
<script>
    $(function(){
        $(".headerpage").load("header.html",function () {
            $("#type").val(2);
        });
        $(".footerpage").load("footer.html");
    });
    var questionTypeEnum = {1:"土地需求",2:"资金需求",3:"政策扶持",4:"人才招工",5:"保障生产要素",6:"安全保障",7:"行政审批",8:"环境保护",9:"安全生产"};
	var statusEnum = {1:"未处理",2:"已处理"};
    layui.use(['layer', 'table', 'form'], function(){
		var table = layui.table;
            var layer = layui.layer;
			var form = layui.form;
            table.render({
                elem: '#tabledemo'
                ,toolbar: '#toolbarDemo'
                ,height: 500
                ,width: 1000
                ,url: 'http://localhost:8005/question/api/v1/order' //数据接口
                ,headers: {Authorization: $.cookie("token")}
                ,parseData: function (res) {
                    return {
                        "code": 0,
                        "msg": "OK",
                        "count": res.total,
                        "data": res.data
                    };
                }
                ,page: true //开启分页
                ,cols: [[ //表头
                    {field: 'id', title: 'ID', width:"5%", fixed: 'left',  align:'center'}
                    ,{field: 'companyName', title: '企业名称', width:"13%",  align:'center'}
                    ,{field: 'contacts', title: '企业联系人', width:"13%",  align:'center'}
                    ,{field: 'mobile', title: '联系电话', width: "13%",  align:'center'}
                    ,{field: 'questionType', title: '问题类型', width: "13%",  align:'center', templet: function (d) {
                            return questionTypeEnum[d.questionType];
                        }}
                    ,{field: 'acceptAt', title: '受理时间', width: "17%"}
                    ,{field: 'status', title: '状态', width: "8%",  align:'center', templet: function (d) {
							return statusEnum[d.status];
                        }}
					,{
                        field:'right',
                        title: '操作',
                        width:'18%',
                        toolbar:"#barDemo",
                        align:'center'
                    }
                ]]
				,id:'idTest'
            });

        table.on('tool(test)', function(obj){
            //alert(1);
            var data = obj.data;
            if(obj.event === 'detail'){
                layer.open({
                    type:2,
                    title: '修改档案',
                    shadeClose: false,
                    shade: [0.2],
                    maxmin: false, //开启最大化最小化按钮
                    area: ['75%', '80%'],
                    content:['detail.html?replyId=' + data.replyId, 'yes']
                });
            }

            if(obj.event === 'handle'){
                layer.open({
                    type:2,
                    title: '修改档案',
                    shadeClose: false,
                    shade: [0.2],
                    maxmin: false, //开启最大化最小化按钮
                    area: ['75%', '80%'],
                    content:['handle.html?replyId=' + data.replyId, 'yes'],
                    end: function(index, layero){
                        table.reload('idTest', {
                            page: {
                                curr: 1 //重新从第 1 页开始
                            }
                        });
                    }
                });
            }
        });
	});
</script>
</html>